# ページネーション問題の最終分析と解決策

## 問題の概要

固定ページ「サービス」（`/services/`）でページネーションをクリックすると404エラーが発生する。

## 試した解決策

### 1. ページネーションのフォーマット変更
- `/services/page/2/` → `/services/?paged=2`
- **結果**: 404エラーは継続

### 2. 固定ページテンプレートへの変更
- `archive-tax_service.php` → `page-services.php`
- **結果**: 404エラーは継続

### 3. ページネーションの手動生成
- `paginate_links()` → 手動でリンク生成
- **結果**: 404エラーは継続

### 4. functions.phpでクエリ変数を登録
- `add_query_var('paged')`
- `parse_request`フックで処理
- **結果**: 404エラーは継続

## 根本原因

WordPressは固定ページで`paged`クエリ変数を使用すると、存在しないページとして404エラーを返す仕様になっています。

これは、固定ページは通常1ページのみで、複数ページに分割されることを想定していないためです。

## 推奨される解決策

### オプション1: カスタム投稿タイプのアーカイブに戻す（推奨）

**実装方法**:
1. `tax_office`カスタム投稿タイプのアーカイブスラッグを`services`に変更
2. `archive-tax_office.php`を修正して税理士サービスも表示
3. `/services/`が`tax_office`のアーカイブページになる
4. ページネーションは`/services/page/2/`で動作

**メリット**:
- WordPressの標準機能を使用
- ページネーションが正しく動作
- SEO対応

**デメリット**:
- `tax_office`のスラッグを変更する必要がある

### オプション2: Ajax ページネーション

**実装方法**:
1. JavaScriptでページ切り替えを実装
2. REST APIで税理士事務所データを取得
3. URLを変更せずにコンテンツを動的に更新

**メリット**:
- URLの問題を回避
- スムーズなユーザー体験

**デメリット**:
- JavaScriptが必要
- SEOに不利

### オプション3: 別のページスラッグを使用

**実装方法**:
1. 固定ページのスラッグを`search-offices`に変更
2. `/services/`は`tax_service`のアーカイブページとして使用
3. `/search-offices/`で税理士事務所を検索

**メリット**:
- 既存の構造を維持
- ページネーションが動作

**デメリット**:
- URLが変更される
- ユーザーに混乱を与える可能性

## 次のステップ

どの解決策を採用するか決定してください。

**推奨**: オプション1（カスタム投稿タイプのアーカイブに戻す）
